{
  "hash": "4e014f086f7e87f8808a1934643326c6",
  "result": {
    "markdown": "---\ntitle: \"Taller: Descripción de variables de tiempo\"\nauthor: \"Percy Soto Becerra\"\n---\n\n\n## Introducción\n\nVamos a resolver una serie de ejercicios acerca de gráfocps de variables categóricas. Usaremos un conjunto de datos juguetes acerca de casos de pacientes con Ébola que se atendieron en hospitales de África. Estos datos están disponibles en el libro [The Epidemiologist Handbook](https://epirhandbook.com/en/index.html).\n\n## Cargar paquetes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)      # Paquete con paquetes de funciones diverssa: {dplyr}, {ggplot2}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(rio)            # Navaja suiza de la importacion de datos en R\nlibrary(skimr)          # Exploración de datos\nlibrary(summarytools)   # Para generar estadísticos descriptivos\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'summarytools'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:tibble':\n\n    view\n```\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)      # Paquete para manipular fechas usando estilo R tidy\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(survival)       # Paquete principal para análisis de datos tiempo-evento\nlibrary(ggsurvfit)      # Paquete para análisis de datos tiempo-evento usando tidy style (ggplot2)\nlibrary(survminer)      # Paquete para analisi de datos tiempo-evento usando tidy style\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggpubr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'survminer'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:survival':\n\n    myeloma\n```\n:::\n:::\n\n\n\n## Importar datos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nebola_data_small <- import(\"ebola_data_small.rds\")\n```\n:::\n\n\n\n## Análisis Inicial de Datos\n\n- Ver 6 primeras filas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(ebola_data_small)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  case_id date_onset date_outcome outcome\n  <chr>   <chr>      <chr>        <chr>  \n1 5fe599  2014-05-13 <NA>         <NA>   \n2 8689b7  2014-05-13 2014-05-18   Recover\n3 11f8ea  2014-05-16 2014-05-30   Recover\n4 b8812a  2014-05-18 <NA>         <NA>   \n5 893f25  2014-05-21 2014-05-29   Recover\n6 be99c8  2014-05-22 2014-05-24   Recover\n```\n:::\n:::\n\n\n- Vistazo a datos:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nebola_data_small %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 5,888\nColumns: 4\n$ case_id      <chr> \"5fe599\", \"8689b7\", \"11f8ea\", \"b8812a\", \"893f25\", \"be99c8…\n$ date_onset   <chr> \"2014-05-13\", \"2014-05-13\", \"2014-05-16\", \"2014-05-18\", \"…\n$ date_outcome <chr> NA, \"2014-05-18\", \"2014-05-30\", NA, \"2014-05-29\", \"2014-0…\n$ outcome      <chr> NA, \"Recover\", \"Recover\", NA, \"Recover\", \"Recover\", \"Reco…\n```\n:::\n:::\n\n\n- Un poco má de detalles:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nebola_data_small %>% \n  skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |5888       |\n|Number of columns        |4          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |4          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|case_id       |         0|          1.00|   6|   6|     0|     5888|          0|\n|date_onset    |       256|          0.96|  10|  10|     0|      367|          0|\n|date_outcome  |       936|          0.84|  10|  10|     0|      371|          0|\n|outcome       |      1323|          0.78|   5|   7|     0|        2|          0|\n:::\n:::\n\n\n- Veamos los datos categoricos: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ebola_data_small %>% \n#   freq()\n```\n:::\n\n\n- Veamos los datos numéricos: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ebola_data_small %>% \n#   descr()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(ebola_data_small$outcome, useNA = \"always\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  Death Recover    <NA> \n   2582    1983    1323 \n```\n:::\n:::\n\n\n## Crear los datos de tiempo a evento y el indicador del evento\n\n\n::: {.cell}\n\n:::\n\n\n- Verificando creación de variable muerte: \n\n\n::: {.cell}\n\n:::\n\n\n- **Nota:** Si la fecha esta en otros formatos, solo se permuta la y, m y d:\n\n\"13-02-2021\" --> dmy(\"13-02-2021\")\n\n\"02-13-2021\" --> mdy(\"02-13-2021\")\n\n## Calcular tasa/ densidad de incidencia\n\n- Dado que tenemos datos individuales, podemos calcular la densidad de incidencia de muerte:\n\n\n::: {.cell}\n\n:::\n\nLa densidad de incidencia de muerte en pacientes con ébola fue de ....\n\n## Configurar objeto survival para cálculo de incidencia/supervivencia acumulada\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Surv(tseg, muerte) ~  1\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n## Imprimir tabla de vida\n\n\n::: {.cell}\n\n:::\n\n\n### R base con summary()\n\n\n::: {.cell}\n\n:::\n\n\n### R tidy con survfit2(), tidy_survfit() de {ggsurvfit}\n\n\n::: {.cell}\n\n:::\n\n\n- Tabla de vida con estimados de supervivencia acumulada:\n\n\n::: {.cell}\n\n:::\n\n\n- Tabla de vida con estimados de incidencia acumulada:\n\n\n::: {.cell}\n\n:::\n\n\n- Solo extraer tiempo, n.event, n.risk y estimado de IA\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## Crear curva de supervivencia mediante método de Kaplan-Meier\n\n### R base con plot() de {survival}\n\n\n::: {.cell}\n\n:::\n\n\n### R tidy con ggsurvfit() de {ggsurvfit}\n\n\n::: {.cell}\n\n:::\n\n\n### Extra: R tidy con ggsurvplot() de {survminer}\n\n\n::: {.cell}\n\n:::\n\n\n## Personalizar curvas de supervivencia de {ggsurvfit}\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}