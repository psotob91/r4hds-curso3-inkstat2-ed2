{
  "hash": "dbe29c07e95dd21fd651d6f1d758b3e0",
  "result": {
    "markdown": "---\ntitle: \"Taller: Análisis Inicial de Datos\"\n---\n\n\n## Introducción\n\nVamos a resolver una serie de ejercicios de análisis inicial de datos y manejo de datos. Para esto, vamos a hacer uso de la base de datos `maca_meno_perclin_modif.xlsx`. Esta es una base de datos simulada y modificada para los fines de este ejercicio, la cual se basa en el estudio **\"Effect of a natural supplement containing glucosinolates, phytosterols and citrus flavonoids on body weight and metabolic parameters in a menopausal murine model induced by bilateral ovariectomy\"** publicado en la revista **Gynecological Endocrinology** en 2020. El experimento detallado puede leerse en el artículo original el cual se encuentra en este [enlace web](https://doi.org/10.1080/09513590.2020.1821639). \n\nEste fue un experimento para evaluar el efecto de un **suplemento** basado en una preparación herbal que contiene glucosinolatos, fitosteroles y citrus flavonoides en desenlaces metabólicos usalmente afectados por la menopausia: peso, colesterol, triglicéridos, glucosa e índice glucosa / triglicéridos. La pregunta PICO es la siguiente:\n\n**P:** Ratones sometidos a ovarectomía bilateral mediante un modelo animal de menopausia quirúrgica.\n\n**I1:** Suplemento oral 0.5625 mg/kg/día administrada por vía oral\n\n**I2:** Suplemento oral 1.6875 mg/kg/día administrada por vía oral\n\n**C1:** Extracto de maca gelatinizada 0.5625 mg/kg/día administrada por vía oral\n\n**C2:** Solución salina 100 µl/kg/día por vía oral\n\n**Os:** Peso, colesterol, triglicéridos, glucosa e índice glucosa / triglicéridos.\n\n**Control Sham**: Hubo un control sham que recibió solución salina 100 µl/kg/día por vía oral y además fue sometido a una cirugía ficticia que no indujo menopausia quirúrgica.\n\nEl libro de códigos se encuentra en el mismo archivo excel, pero en otra hoja denominada `codebook`.\n\nHemos pre-escrito parte del código para facilitar el desarrollo del ejercicio y agregado algunos comentarios. Hemos dejado una línea en blanco ____ para solicitar que Ud. complete el ejercicio. Elimine la línea _____ y remplacela por su respuesta.\n\n\n## Cargar paquetes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # Paquetes variados de universo tidyverse (dplyr, ggplot2, etc.)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(rio)        # Para importar casi cualquier tipo de formato.\nlibrary(skimr)      # Funcion skim() para explorar rápidamente variables categóricas y numéricas.\nlibrary(Hmisc)      # Proporciona función describe() que es muy similar a skim()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Formula\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Hmisc'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:dplyr':\n\n    src, summarize\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n```\n:::\n\n```{.r .cell-code}\nlibrary(janitor)    # Miscelánea de funciones basadas en tidyverse para manejo y reporte de datos.\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'janitor'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n:::\n\n```{.r .cell-code}\nlibrary(visdat)     # Funciones para visualizar datos faltantes\nlibrary(tidyr)      # FUnciones para manejo y limpieza de datos\nlibrary(VIM)        # Funciones para datos perdidos\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: colorspace\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: grid\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nVIM is ready to use.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSuggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'VIM'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:datasets':\n\n    sleep\n```\n:::\n\n```{.r .cell-code}\nlibrary(naniar)     # Funciones para datos perdidos\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'naniar'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:skimr':\n\n    n_complete\n```\n:::\n:::\n\n\n**Nota:** Recuerda instalar el paquete si no lo tienes hecho aún.\n\n## Importar base de datos\n\nUsaremos la navaja suiza de la importación de datos en R: el paquete {rio} y su función `import()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data <- import(\"maca_meno_perclin_modif.xlsx\")\n```\n:::\n\n\n## Paso 1: Resumen global de los datos\n\nLa función `glimpse()` ('hechar un vistazo') del paquete `{dplyr}` de `{tidyverse}` es muy útil para identificar rápidamente las características generales de los datos (número de filas, columnas y lista de variables con pequeña salida de ejemplo).\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 26\nColumns: 13\n$ id_jaula     <dbl> 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 5, 5, 5, 5, 8, 8, 9, 9, 9, …\n$ id_raton     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…\n$ tratamiento  <chr> \"control\", \"control\", \"control\", \"control\", \"control\", \"m…\n$ protocolo    <chr> \"ovx\", \"ovx\", \"ovx\", \"hemiovx\", \"ovx\", \"ovx\", \"ovx\", \"ovx…\n$ peso_inicial <dbl> 26.00, 24.50, 20.40, 26.59, 23.50, 25.00, 24.80, 23.20, 2…\n$ peso_final   <dbl> 33.28, 30.50, 29.93, 32.19, 30.37, 30.43, 28.77, 27.30, 2…\n$ peso_utero   <dbl> 123.000, 0.063, 0.078, 0.134, 0.052, 0.055, 0.064, 0.062,…\n$ chol         <dbl> 85.990, 94.460, 99.670, 83.380, 82.080, 107.490, 76.870, …\n$ glucose      <dbl> 109.97, 81.62, 118.37, 71.91, 95.53, 160.36, 195.53, 182.…\n$ tag          <dbl> 182.42, 211.87, 195.16, 98.46, 108.13, 141.10, 95.82, 105…\n$ prot         <dbl> 43131.00, 4.68, NA, NA, 5.33, NA, 5.02, 6.12, NA, 4.85, -…\n$ urea         <dbl> 66.27, 76.73, 52.32, 50.71, 26.02, NA, 40.78, 66.94, NA, …\n$ album        <dbl> 66.82, 55.36, NA, NA, NA, 72.14, 67.09, 70.64, 66.27, 83.…\n```\n:::\n:::\n\n\nPodemos usar también la función `skim()` del paquete `{skimr}` para tener un ersumen detallado de cada una de las variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>%\n  skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |26         |\n|Number of columns        |13         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |2          |\n|numeric                  |11         |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|tratamiento   |         0|             1|   4|  25|     0|        5|          0|\n|protocolo     |         0|             1|   3|  11|     0|        4|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|       sd|      p0|    p25|    p50|    p75|     p100|hist  |\n|:-------------|---------:|-------------:|-------:|--------:|-------:|------:|------:|------:|--------:|:-----|\n|id_jaula      |         0|          1.00|    5.04|     3.40|    1.00|   2.00|   5.00|   8.75|    10.00|▇▂▃▂▆ |\n|id_raton      |         0|          1.00|   10.81|     7.21|    1.00|   4.25|  10.50|  16.75|    23.00|▇▃▅▃▅ |\n|peso_inicial  |         0|          1.00|   23.77|     2.14|   18.90|  22.55|  23.50|  25.23|    27.90|▃▃▇▇▃ |\n|peso_final    |         1|          0.96|   28.83|     2.30|   23.80|  27.30|  28.77|  30.27|    33.28|▂▆▇▆▃ |\n|peso_utero    |         0|          1.00|    4.82|    24.10|    0.01|   0.06|   0.07|   0.09|   123.00|▇▁▁▁▁ |\n|chol          |         1|          0.96|   82.83|    12.85|   59.28|  74.26|  83.38|  88.59|   107.49|▅▃▇▂▃ |\n|glucose       |         0|          1.00|  123.36|    35.21|   60.10| 104.46| 116.53| 143.83|   195.53|▃▇▇▃▃ |\n|tag           |         0|          1.00|  156.94|    50.37|   90.99| 109.78| 151.87| 192.63|   282.64|▇▃▇▁▂ |\n|prot          |         8|          0.69| 2177.95| 10229.41| -999.00|   4.70|   4.97|   5.36| 43131.00|▇▁▁▁▁ |\n|urea          |         9|          0.65|   57.78|    29.34|   26.02|  40.78|  52.32|  66.27|   157.89|▇▅▁▁▁ |\n|album         |        13|          0.50|   66.25|     7.71|   52.77|  64.64|  66.82|  68.59|    83.73|▂▂▇▁▁ |\n:::\n:::\n\n\nO podemos usar la función `describe()` del paquete `{Hmisc}`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>%\n  describe()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n. \n\n 13  Variables      26  Observations\n--------------------------------------------------------------------------------\nid_jaula \n       n  missing distinct     Info     Mean      Gmd \n      26        0        8     0.98    5.038    3.905 \n\nlowest :  1  2  3  5  7, highest:  5  7  8  9 10\n                                                          \nValue          1     2     3     5     7     8     9    10\nFrequency      5     4     3     4     1     2     4     3\nProportion 0.192 0.154 0.115 0.154 0.038 0.077 0.154 0.115\n--------------------------------------------------------------------------------\nid_raton \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      26        0       23    0.998    10.81    8.452     1.00     1.50 \n     .25      .50      .75      .90      .95 \n    4.25    10.50    16.75    20.50    21.75 \n\nlowest :  1  2  3  4  5, highest: 19 20 21 22 23\n--------------------------------------------------------------------------------\ntratamiento \n       n  missing distinct \n      26        0        5 \n\nlowest : control                   maca                      maca + critro             sham operated             triple dosis maca + citro\nhighest: control                   maca                      maca + critro             sham operated             triple dosis maca + citro\n\ncontrol (8, 0.308), maca (5, 0.192), maca + critro (4, 0.154), sham operated\n(4, 0.154), triple dosis maca + citro (5, 0.192)\n--------------------------------------------------------------------------------\nprotocolo \n       n  missing distinct \n      26        0        4 \n                                                          \nValue      desconocido     hemiovx      no ovx         ovx\nFrequency            2           2           4          18\nProportion       0.077       0.077       0.154       0.692\n--------------------------------------------------------------------------------\npeso_inicial \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      26        0       20    0.998    23.77    2.449    20.40    21.15 \n     .25      .50      .75      .90      .95 \n   22.55    23.50    25.23    26.30    26.90 \n\nlowest : 18.90 20.40 21.90 22.40 22.50, highest: 25.50 26.00 26.59 27.00 27.90\n                                                                            \nValue      18.90 20.40 21.90 22.40 22.50 22.69 22.90 23.20 23.40 23.50 23.90\nFrequency      1     2     2     1     1     1     1     1     2     2     1\nProportion 0.038 0.077 0.077 0.038 0.038 0.038 0.038 0.038 0.077 0.077 0.038\n                                                                \nValue      24.50 24.80 25.00 25.30 25.50 26.00 26.59 27.00 27.90\nFrequency      2     1     1     1     1     2     1     1     1\nProportion 0.077 0.038 0.038 0.038 0.038 0.077 0.038 0.038 0.038\n--------------------------------------------------------------------------------\npeso_final \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      25        1       21    0.998    28.83    2.617    25.28    26.69 \n     .25      .50      .75      .90      .95 \n   27.30    28.77    30.27    31.51    33.06 \n\nlowest : 23.80 24.93 26.68 26.70 26.86, highest: 30.37 30.43 30.50 32.19 33.28\n--------------------------------------------------------------------------------\npeso_utero \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      26        0       24    0.999    4.819    9.521  0.01750  0.03400 \n     .25      .50      .75      .90      .95 \n 0.05825  0.07300  0.08900  0.15500  0.44525 \n\nlowest :   0.014   0.016   0.022   0.046   0.052\nhighest:   0.113   0.134   0.176   0.535 123.000\n                                  \nValue        0.0   0.2   0.6 123.0\nFrequency     20     4     1     1\nProportion 0.769 0.154 0.038 0.038\n\nFor the frequency table, variable is rounded to the nearest 0.2\n--------------------------------------------------------------------------------\nchol \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      25        1       21    0.998    82.83    14.86    64.68    66.31 \n     .25      .50      .75      .90      .95 \n   74.26    83.38    88.59    99.67   103.84 \n\nlowest :  59.28  64.40  65.79  67.10  68.40, highest:  94.46  95.76  99.67 104.88 107.49\n--------------------------------------------------------------------------------\nglucose \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      26        0       23    0.998    123.4    40.35    73.49    79.92 \n     .25      .50      .75      .90      .95 \n  104.46   116.53   143.83   175.45   183.98 \n\nlowest :  60.10  71.91  78.22  81.62  94.23, highest: 160.36 168.50 182.41 184.51 195.53\n--------------------------------------------------------------------------------\ntag \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      26        0       22    0.998    156.9    57.44    93.85    97.14 \n     .25      .50      .75      .90      .95 \n  109.78   151.87   192.63   205.94   236.60 \n\nlowest :  90.99  93.19  95.82  98.46 105.49, highest: 199.12 200.00 211.87 244.84 282.64\n--------------------------------------------------------------------------------\nprot \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      18        8       12    0.987     2178     5160 -999.000 -999.000 \n     .25      .50      .75      .90      .95 \n   4.705    4.975    5.360    6.135 6474.894 \n\nlowest :  -999.00     4.68     4.78     4.85     4.93\nhighest:     5.33     5.37     6.12     6.17 43131.00\n                                                                         \nValue       -999.00     4.68     4.78     4.85     4.93     5.02     5.15\nFrequency         4        1        1        1        2        1        1\nProportion    0.222    0.056    0.056    0.056    0.111    0.056    0.056\n                                                       \nValue          5.33     5.37     6.12     6.17 43131.00\nFrequency         2        2        1        1        1\nProportion    0.111    0.111    0.056    0.056    0.056\n--------------------------------------------------------------------------------\nurea \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      17        9       14    0.994    57.78    27.46    32.79    36.57 \n     .25      .50      .75      .90      .95 \n   40.78    52.32    66.27    70.86    92.96 \n\nlowest :  26.02  34.48  37.96  38.23  40.78, highest:  60.37  66.27  66.94  76.73 157.89\n                                                                         \nValue       26.02  34.48  37.96  38.23  40.78  43.06  45.61  50.71  52.32\nFrequency       1      1      1      1      1      1      1      1      2\nProportion  0.059  0.059  0.059  0.059  0.059  0.059  0.059  0.059  0.118\n                                             \nValue       60.37  66.27  66.94  76.73 157.89\nFrequency       1      3      1      1      1\nProportion  0.059  0.176  0.059  0.059  0.059\n--------------------------------------------------------------------------------\nalbum \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      13       13       11    0.989    66.25    8.394    54.32    56.21 \n     .25      .50      .75      .90      .95 \n   64.64    66.82    68.59    71.84    76.78 \n\nlowest : 52.77 55.36 59.59 64.64 66.27, highest: 67.09 68.59 70.64 72.14 83.73\n                                                                            \nValue      52.77 55.36 59.59 64.64 66.27 66.82 67.09 68.59 70.64 72.14 83.73\nFrequency      1     1     1     1     1     3     1     1     1     1     1\nProportion 0.077 0.077 0.077 0.077 0.077 0.231 0.077 0.077 0.077 0.077 0.077\n--------------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## Paso 2: Detecte y maneje duplicados\n\nLa primera pregunta que debemos hacernos con esta base de datos es **¿cuál es la variable ID que debe ser única?** Si bien hay dos variables id: `id_jaula` y `id_raton`, solo `id_raton` es la variable que debería ser única, ya que varios ratones podían compartir la misma jaula como parte del experimento.\n\nUna forma muy informal de buscar datos duplicados es inspeccionado en data frame con la función `View()` de R base o dándole click al ícono de matriz de cálculo que aparece a la derecha del objeto `preclin_data` mostrado en el `Environment`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   id_jaula id_raton               tratamiento   protocolo peso_inicial\n1         1        1                   control         ovx        26.00\n2         1        2                   control         ovx        24.50\n3         1        3                   control         ovx        20.40\n4         2        4                   control     hemiovx        26.59\n5         2        5                   control         ovx        23.50\n6         2        6                      maca         ovx        25.00\n7         2        7                      maca         ovx        24.80\n8         3        8                      maca         ovx        23.20\n9         3        9                      maca     hemiovx        22.69\n10        3       10                      maca         ovx        23.90\n11        5       11             maca + critro desconocido        21.90\n12        5       12             maca + critro         ovx        23.40\n13        5       13             maca + critro         ovx        21.90\n14        5       14             maca + critro         ovx        22.40\n15        8       15 triple dosis maca + citro         ovx        18.90\n16        8       16 triple dosis maca + citro         ovx        23.50\n17        9       17 triple dosis maca + citro         ovx        24.50\n18        9       18 triple dosis maca + citro         ovx        25.30\n19        9       19 triple dosis maca + citro         ovx        27.90\n20        9       20             sham operated      no ovx        25.50\n21       10       21             sham operated      no ovx        23.40\n22       10       22             sham operated      no ovx        22.50\n23       10       23             sham operated      no ovx        22.90\n24        1        1                   control desconocido        26.00\n25        1        3                   control         ovx        20.40\n26        7        1                   control         ovx        27.00\n   peso_final peso_utero    chol glucose    tag     prot   urea album\n1       33.28    123.000  85.990  109.97 182.42 43131.00  66.27 66.82\n2       30.50      0.063  94.460   81.62 211.87     4.68  76.73 55.36\n3       29.93      0.078  99.670  118.37 195.16       NA  52.32    NA\n4       32.19      0.134  83.380   71.91  98.46       NA  50.71    NA\n5       30.37      0.052  82.080   95.53 108.13     5.33  26.02    NA\n6       30.43      0.055 107.490  160.36 141.10       NA     NA 72.14\n7       28.77      0.064  76.870  195.53  95.82     5.02  40.78 67.09\n8       27.30      0.062  95.760  182.41 105.49     6.12  66.94 70.64\n9       26.86      0.070  85.340  184.51  90.99       NA     NA 66.27\n10      29.10      0.113  82.080  168.50 143.30     4.85  34.48 83.73\n11      24.93      0.108  80.781  113.38 128.35  -999.00     NA    NA\n12      26.70      0.022  88.590  102.62 282.64  -999.00     NA    NA\n13      28.67      0.014 104.880   60.10 200.00     5.33  37.96    NA\n14      28.37      0.046  70.350  150.13 199.12     4.93  45.61 64.64\n15      23.80      0.057  78.170  110.50 114.73     4.78  38.23 52.77\n16      26.70      0.065  85.340  144.88 134.51     5.15  43.06 59.59\n17      28.77      0.016  64.400  138.85 160.44  -999.00     NA    NA\n18      29.20      0.068  67.100  140.68 127.03  -999.00     NA    NA\n19      29.48      0.076  65.790  114.70 169.67     6.17     NA    NA\n20      30.27      0.088  74.260   94.23 185.05     4.93     NA 68.59\n21      27.90      0.535  59.280  126.77 244.84       NA  60.37    NA\n22      26.68      0.081  68.400   78.22  93.19       NA 157.89    NA\n23      27.43      0.176  84.690  125.20 108.13       NA     NA    NA\n24      33.28      0.089  85.990  109.97 182.42     5.37  66.27 66.82\n25      29.93      0.078  99.670  118.37 195.16       NA  52.32    NA\n26         NA      0.089      NA  109.97 182.42     5.37  66.27 66.82\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nView(preclin_data)\n```\n:::\n\n\nDe la inspección de esta matriz de cálculo, podemos apreciar que efectivamente hay datos duplicados. Si bien esta forma puede ayudar cuand los datos son de tamaño pequeño y manejable, no es útil cuando se tienen muchísimos datos. Se necesita un método que detecte todos los duplicados sin posibilidad de que se escape algún duplicado. \n\nPara esto, podemos usar la función `get_dupes()` del paquete `{janitor}`, el cual permite hacer el diagnóstico de observaciones duplicadas en todo el conjunto de datos.\n\nLo primero es identificar si hay algún duplicado de observación completa, es decir, que hayan dos o más filas que sean exactamente iguales entre sí en todas sus variables. Esta es la forma mas obvia de duplicación de datos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>%\n  get_dupes()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo variable names specified - using all columns.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n  id_jaula id_raton tratamiento protocolo peso_inicial peso_final peso_utero\n1        1        3     control       ovx         20.4      29.93      0.078\n2        1        3     control       ovx         20.4      29.93      0.078\n   chol glucose    tag prot  urea album dupe_count\n1 99.67  118.37 195.16   NA 52.32    NA          2\n2 99.67  118.37 195.16   NA 52.32    NA          2\n```\n:::\n:::\n\n\nSe observa que hay duplicados de fila, por lo que uno puede proceder a eliminarlos sin ninguna preocupación. Al ser filas exactamente iguales, no importa cuál de las filas elimine, solo necesito quedarme con una de estas. Es muy importante guardar el data frame para poder seguir limpiando sobre este:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>% \n  distinct(.keep_all = TRUE) -> preclin_data2\n```\n:::\n\n\nUna forma más sutil es cuando solo hay duplicación del ID pero no de la fila entera. En estos casos la pregunta que surge es ¿qué fila es la correcta? En esta base de datos podemos verificar este tipo de duplicación también haciendo uso de `get_dupes()` e indicando la o las variables donde se desea identificar el duplicado.\n\nVeamos si todavía hay duplicados en la base de datos. Trabajaremos sobre el data frame nuevo `preclin_data2` al cual ya se le quitaron los duplicados de fila completa. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data2 %>% \n  get_dupes(id_raton)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id_raton dupe_count id_jaula tratamiento   protocolo peso_inicial peso_final\n1        1          3        1     control         ovx           26      33.28\n2        1          3        1     control desconocido           26      33.28\n3        1          3        7     control         ovx           27         NA\n  peso_utero  chol glucose    tag     prot  urea album\n1    123.000 85.99  109.97 182.42 43131.00 66.27 66.82\n2      0.089 85.99  109.97 182.42     5.37 66.27 66.82\n3      0.089    NA  109.97 182.42     5.37 66.27 66.82\n```\n:::\n:::\n\n\nSe aprecia que el ratón con id_raton de 1 se repite 3 veces pero solo debería aparecer una vez. Además, a pesar de ser el mismo ratón, supuestamente, tiene valores distitntos para la variable id_jaula y la variable protocolo. La pregunta clave aquí es ¿cuál de todas las filas es la fila correcta y cuáles son filas que debamos eliminar? La solución requiere conocer los datos originales, verificar la fuente de los datos y otros elementos propios de la investigación.\n\nSupongamos que luego de revisar los documentos fuente y hacer algunas otras validaciones, logras determinar que la fila correcta es la del raton que tiene protocolo = \"ovx\" y id_jaula = 1. Entonces, debes eliminar las otras dos filas equivocadas que son duplicados de ratón pero con datos erróneos. Podemos hacer esto usando la función `filter()`. No se olviden de guardar los datos para poder trabajar con los datos nuevos sin duplicados.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data2 %>% \n  filter(!(id_raton == 1 & protocolo == \"desconocido\")) %>% \n  filter(!(id_raton == 1 & id_jaula == 7)) -> preclin_data3\n```\n:::\n\n\n\n## Paso 3: Datos faltantes\n\n### Paso 3.1: Identifique datos faltantes\n\nPodemos usar `skim()` para hacernos una idea de los datos faltantes. Aplicaremos esta función sobre el data frame sin duplicados que creamos anteriormente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |23         |\n|Number of columns        |13         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |2          |\n|numeric                  |11         |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|tratamiento   |         0|             1|   4|  25|     0|        5|          0|\n|protocolo     |         0|             1|   3|  11|     0|        4|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|       sd|      p0|     p25|    p50|    p75|     p100|hist  |\n|:-------------|---------:|-------------:|-------:|--------:|-------:|-------:|------:|------:|--------:|:-----|\n|id_jaula      |         0|          1.00|    5.30|     3.38|    1.00|    2.00|   5.00|   9.00|    10.00|▇▃▅▂▇ |\n|id_raton      |         0|          1.00|   12.00|     6.78|    1.00|    6.50|  12.00|  17.50|    23.00|▇▆▇▆▇ |\n|peso_inicial  |         0|          1.00|   23.68|     1.99|   18.90|   22.59|  23.50|  24.90|    27.90|▂▃▇▇▂ |\n|peso_final    |         0|          1.00|   28.59|     2.18|   23.80|   27.08|  28.77|  30.10|    33.28|▂▆▇▅▂ |\n|peso_utero    |         0|          1.00|    5.44|    25.63|    0.01|    0.06|   0.07|   0.10|   123.00|▇▁▁▁▁ |\n|chol          |         0|          1.00|   81.96|    12.89|   59.28|   72.31|  82.08|  87.29|   107.49|▅▃▇▃▃ |\n|glucose       |         0|          1.00|  124.74|    37.27|   60.10|   99.08| 118.37| 147.50|   195.53|▅▇▇▃▅ |\n|tag           |         0|          1.00|  153.06|    52.36|   90.99|  108.13| 141.10| 190.11|   282.64|▇▃▅▁▂ |\n|prot          |         7|          0.70| 2449.52| 10857.48| -999.00| -246.24|   4.93|   5.33| 43131.00|▇▁▁▁▁ |\n|urea          |         9|          0.61|   56.95|    32.34|   26.02|   38.87|  48.16|  64.80|   157.89|▇▃▁▁▁ |\n|album         |        12|          0.48|   66.15|     8.44|   52.77|   62.12|  66.82|  69.62|    83.73|▃▃▇▂▂ |\n:::\n:::\n\n \nTambién podemos hacer uso de gráficos de datos faltantes para mejorar la comprensión de estos. La función `vis_dat()` del paquete `{vis_dat}` ofrece buenas soluciones gráficas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  vis_dat()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nPlease use `gather()` instead.\nThis warning is displayed once every 8 hours.\nCall `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.\n```\n:::\n\n::: {.cell-output-display}\n![](aid_taller_solucionario_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nOtra función muy útil es `vis_miss()` que te da el porcentaje de datos faltantes por variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  vis_miss()\n```\n\n::: {.cell-output-display}\n![](aid_taller_solucionario_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\nSi queremos ver cómo se combinan los datos faltantes por variable, la librería `{VIM}` ofrece la función `aggr()` que permite una rápida visualización.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  aggr(numbers = TRUE)\n```\n\n::: {.cell-output-display}\n![](aid_taller_solucionario_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nTambién podemos usar la función `gg_miss_upset()` del paquete `{naniar}`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  gg_miss_upset()\n```\n\n::: {.cell-output-display}\n![](aid_taller_solucionario_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nPodemos inspeccionar los datos solo de los individuos con datos faltantes usando `filter()`. Por ejemplo, si queremos saber quienes son los individuos que tienen datos faltantes en la variable urea, podemos hacerlo fácilmente usando `is.na()` dentro de `filter()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  filter(is.na(urea))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id_jaula id_raton               tratamiento   protocolo peso_inicial\n1        2        6                      maca         ovx        25.00\n2        3        9                      maca     hemiovx        22.69\n3        5       11             maca + critro desconocido        21.90\n4        5       12             maca + critro         ovx        23.40\n5        9       17 triple dosis maca + citro         ovx        24.50\n6        9       18 triple dosis maca + citro         ovx        25.30\n7        9       19 triple dosis maca + citro         ovx        27.90\n8        9       20             sham operated      no ovx        25.50\n9       10       23             sham operated      no ovx        22.90\n  peso_final peso_utero    chol glucose    tag    prot urea album\n1      30.43      0.055 107.490  160.36 141.10      NA   NA 72.14\n2      26.86      0.070  85.340  184.51  90.99      NA   NA 66.27\n3      24.93      0.108  80.781  113.38 128.35 -999.00   NA    NA\n4      26.70      0.022  88.590  102.62 282.64 -999.00   NA    NA\n5      28.77      0.016  64.400  138.85 160.44 -999.00   NA    NA\n6      29.20      0.068  67.100  140.68 127.03 -999.00   NA    NA\n7      29.48      0.076  65.790  114.70 169.67    6.17   NA    NA\n8      30.27      0.088  74.260   94.23 185.05    4.93   NA 68.59\n9      27.43      0.176  84.690  125.20 108.13      NA   NA    NA\n```\n:::\n:::\n\n\n\n### Paso 3.2: Manejo de los datos faltantes\n\nImaginemos que sabemos que el ratón con `id == 6` tiene un valor de úrea `65.2`. Como vemos en la tabla de datos de arriba, ese valor está faltando. Nosotros podemos corregir este valor usando código. Para esto podemos hacer uso de la función `replace()` tal y como sigue:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data3 %>% \n  mutate(urea = replace(urea, id_raton == 6, 65.2)) -> preclin_data4\n```\n:::\n\n\nOtro problema clásico en el análisis inicial de datos y su limpieza es que encontramos valores perdidos camuflados, que no parecen perdidos a menos que uno los inspeccione detalladamente. Por ejemplo, veamos qué pasa con estas dos variables `prot` y `protocolo`.\n\nNotar que estas hay valores perdidos que han sido etiquetados como `-999` o `desconocido` respectivamente. Estos valores deberían ser transformados `NA` para que R los considere datos faltantes. Esto se puede lograr fácilmente usando la función `na_if()` del paquete `{tidyr}`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data4 %>% \n  na_if(list(prot = -999)) -> preclin_data5\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data5 %>% \n    na_if(list(protocolo = \"desconocido\")) -> preclin_data6\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data4 %>% \n  na_if(list(prot = -999)) %>% \n  na_if(list(protocolo = \"desconocido\")) -> preclin_data7\n```\n:::\n\n\n## Paso 4: Valores extremos no plausibles\n\nPara identificar valores extremos no plausibles, puede ayudar  ver los valores mínimos y máximo usando `skim()` o `describe()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data7 %>% \n  skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |23         |\n|Number of columns        |13         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |2          |\n|numeric                  |11         |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|tratamiento   |         0|          1.00|   4|  25|     0|        5|          0|\n|protocolo     |         1|          0.96|   3|   7|     0|        3|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|       sd|    p0|    p25|    p50|    p75|     p100|hist  |\n|:-------------|---------:|-------------:|-------:|--------:|-----:|------:|------:|------:|--------:|:-----|\n|id_jaula      |         0|          1.00|    5.30|     3.38|  1.00|   2.00|   5.00|   9.00|    10.00|▇▃▅▂▇ |\n|id_raton      |         0|          1.00|   12.00|     6.78|  1.00|   6.50|  12.00|  17.50|    23.00|▇▆▇▆▇ |\n|peso_inicial  |         0|          1.00|   23.68|     1.99| 18.90|  22.59|  23.50|  24.90|    27.90|▂▃▇▇▂ |\n|peso_final    |         0|          1.00|   28.59|     2.18| 23.80|  27.08|  28.77|  30.10|    33.28|▂▆▇▅▂ |\n|peso_utero    |         0|          1.00|    5.44|    25.63|  0.01|   0.06|   0.07|   0.10|   123.00|▇▁▁▁▁ |\n|chol          |         0|          1.00|   81.96|    12.89| 59.28|  72.31|  82.08|  87.29|   107.49|▅▃▇▃▃ |\n|glucose       |         0|          1.00|  124.74|    37.27| 60.10|  99.08| 118.37| 147.50|   195.53|▅▇▇▃▅ |\n|tag           |         0|          1.00|  153.06|    52.36| 90.99| 108.13| 141.10| 190.11|   282.64|▇▃▅▁▂ |\n|prot          |        11|          0.52| 3599.02| 12449.34|  4.68|   4.91|   5.08|   5.53| 43131.00|▇▁▁▁▁ |\n|urea          |         8|          0.65|   57.50|    31.23| 26.02|  39.50|  50.71|  65.74|   157.89|▇▅▁▁▁ |\n|album         |        12|          0.48|   66.15|     8.44| 52.77|  62.12|  66.82|  69.62|    83.73|▃▃▇▂▂ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data7 %>% \n  describe()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n. \n\n 13  Variables      23  Observations\n--------------------------------------------------------------------------------\nid_jaula \n       n  missing distinct     Info     Mean      Gmd \n      23        0        7    0.979    5.304    3.881 \n\nlowest :  1  2  3  5  8, highest:  3  5  8  9 10\n                                                    \nValue          1     2     3     5     8     9    10\nFrequency      3     4     3     4     2     4     3\nProportion 0.130 0.174 0.130 0.174 0.087 0.174 0.130\n--------------------------------------------------------------------------------\nid_raton \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       23        1       12        8      2.1      3.2 \n     .25      .50      .75      .90      .95 \n     6.5     12.0     17.5     20.8     21.9 \n\nlowest :  1  2  3  4  5, highest: 19 20 21 22 23\n--------------------------------------------------------------------------------\ntratamiento \n       n  missing distinct \n      23        0        5 \n\nlowest : control                   maca                      maca + critro             sham operated             triple dosis maca + citro\nhighest: control                   maca                      maca + critro             sham operated             triple dosis maca + citro\n\ncontrol (5, 0.217), maca (5, 0.217), maca + critro (4, 0.174), sham operated\n(4, 0.174), triple dosis maca + citro (5, 0.217)\n--------------------------------------------------------------------------------\nprotocolo \n       n  missing distinct \n      22        1        3 \n                                  \nValue      hemiovx  no ovx     ovx\nFrequency        2       4      16\nProportion   0.091   0.182   0.727\n--------------------------------------------------------------------------------\npeso_inicial \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       19    0.998    23.68    2.244    20.55    21.90 \n     .25      .50      .75      .90      .95 \n   22.59    23.50    24.90    25.90    26.53 \n\nlowest : 18.90 20.40 21.90 22.40 22.50, highest: 25.30 25.50 26.00 26.59 27.90\n                                                                            \nValue      18.90 20.40 21.90 22.40 22.50 22.69 22.90 23.20 23.40 23.50 23.90\nFrequency      1     1     2     1     1     1     1     1     2     2     1\nProportion 0.043 0.043 0.087 0.043 0.043 0.043 0.043 0.043 0.087 0.087 0.043\n                                                          \nValue      24.50 24.80 25.00 25.30 25.50 26.00 26.59 27.90\nFrequency      2     1     1     1     1     1     1     1\nProportion 0.087 0.043 0.043 0.043 0.043 0.043 0.043 0.043\n--------------------------------------------------------------------------------\npeso_final \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       21    0.999    28.59    2.483    25.11    26.68 \n     .25      .50      .75      .90      .95 \n   27.08    28.77    30.10    30.49    32.02 \n\nlowest : 23.80 24.93 26.68 26.70 26.86, highest: 30.37 30.43 30.50 32.19 33.28\n--------------------------------------------------------------------------------\npeso_utero \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       23        1    5.437    10.76   0.0166   0.0268 \n     .25      .50      .75      .90      .95 \n  0.0560   0.0680   0.0980   0.1676   0.4991 \n\nlowest :   0.014   0.016   0.022   0.046   0.052\nhighest:   0.113   0.134   0.176   0.535 123.000\n                                  \nValue        0.0   0.2   0.6 123.0\nFrequency     17     4     1     1\nProportion 0.739 0.174 0.043 0.043\n\nFor the frequency table, variable is rounded to the nearest 0.2\n--------------------------------------------------------------------------------\nchol \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       21    0.999    81.96     14.9    64.54    66.05 \n     .25      .50      .75      .90      .95 \n   72.31    82.08    87.29    98.89   104.36 \n\nlowest :  59.28  64.40  65.79  67.10  68.40, highest:  94.46  95.76  99.67 104.88 107.49\n--------------------------------------------------------------------------------\nglucose \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       23        1    124.7    43.44    72.54    78.90 \n     .25      .50      .75      .90      .95 \n   99.08   118.37   147.50   179.63   184.30 \n\nlowest :  60.10  71.91  78.22  81.62  94.23, highest: 160.36 168.50 182.41 184.51 195.53\n--------------------------------------------------------------------------------\ntag \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      23        0       22        1    153.1    59.41    93.45    96.35 \n     .25      .50      .75      .90      .95 \n  108.13   141.10   190.11   209.50   241.54 \n\nlowest :  90.99  93.19  95.82  98.46 105.49, highest: 199.12 200.00 211.87 244.84 282.64\n--------------------------------------------------------------------------------\nprot \n        n   missing  distinct      Info      Mean       Gmd       .05       .10 \n       12        11        10     0.993      3599      7188     4.735     4.787 \n      .25       .50       .75       .90       .95 \n    4.910     5.085     5.527     6.165 19412.343 \n\nlowest :     4.68     4.78     4.85     4.93     5.02\nhighest:     5.15     5.33     6.12     6.17 43131.00\n                                                                         \nValue          4.68     4.78     4.85     4.93     5.02     5.15     5.33\nFrequency         1        1        1        2        1        1        2\nProportion    0.083    0.083    0.083    0.167    0.083    0.083    0.167\n                                     \nValue          6.12     6.17 43131.00\nFrequency         1        1        1\nProportion    0.083    0.083    0.083\n--------------------------------------------------------------------------------\nurea \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      15        8       15        1     57.5    29.49    31.94    35.87 \n     .25      .50      .75      .90      .95 \n   39.50    50.71    65.73    72.81   101.08 \n\nlowest :  26.02  34.48  37.96  38.23  40.78, highest:  65.20  66.27  66.94  76.73 157.89\n                                                                         \nValue       26.02  34.48  37.96  38.23  40.78  43.06  45.61  50.71  52.32\nFrequency       1      1      1      1      1      1      1      1      1\nProportion  0.067  0.067  0.067  0.067  0.067  0.067  0.067  0.067  0.067\n                                                    \nValue       60.37  65.20  66.27  66.94  76.73 157.89\nFrequency       1      1      1      1      1      1\nProportion  0.067  0.067  0.067  0.067  0.067  0.067\n--------------------------------------------------------------------------------\nalbum \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n      11       12       11        1    66.15    9.592    54.06    55.36 \n     .25      .50      .75      .90      .95 \n   62.12    66.82    69.62    72.14    77.94 \n\nlowest : 52.77 55.36 59.59 64.64 66.27, highest: 67.09 68.59 70.64 72.14 83.73\n                                                                            \nValue      52.77 55.36 59.59 64.64 66.27 66.82 67.09 68.59 70.64 72.14 83.73\nFrequency      1     1     1     1     1     1     1     1     1     1     1\nProportion 0.091 0.091 0.091 0.091 0.091 0.091 0.091 0.091 0.091 0.091 0.091\n--------------------------------------------------------------------------------\n```\n:::\n:::\n\n\nLos gráficos de caja de R base también pueden ayudar a tener una rápida visualización de la variable numérica:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(preclin_data7$prot)\n```\n\n::: {.cell-output-display}\n![](aid_taller_solucionario_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nUna vez identificado el dato no plausible, podemos tratar de corregirlo o, si no es posible, eliminarlo. \n\nPor ejemplo, en el caso de la variable `prot`, el valor `43131` es una valor extremo que podríamos corregir si tuvieramos esta información. Imaginemos que el valor correcto era de 4.5, esto se podría hacer de la siguiente manera:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data7 %>% \n  mutate(prot = recode(prot,  `43131` = 4.5)) -> preclin_data8\n```\n:::\n\n\nEn el caso no pudieramos corregirlo, podríamos convertirlo en dato faltante con la función `na_if()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data7 %>% \n  mutate(prot = na_if(prot,  43131)) -> preclin_data9\n```\n:::\n\n\n## Paso 5: Haga consultas para verificar consistencias\n\nPodemos hacer algunas consultas o `queries` usando las funciones de {dplyr}. Veamos algunas consultas de interés:\n\n\n### a) Seleccione a los ratones de la jaula 5 y muestre sus valores de glucosa y triglicéridos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data9 %>% \n  filter(id_jaula == 5) %>% \n  select(id_jaula, id_raton, glucose, tag)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id_jaula id_raton glucose    tag\n1        5       11  113.38 128.35\n2        5       12  102.62 282.64\n3        5       13   60.10 200.00\n4        5       14  150.13 199.12\n```\n:::\n:::\n\n\n\n### b) Muestre qué ratones tienen niveles de úrea mayores a 60 pero niveles de glucosa entre 100 y 160 inclusive.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data9 %>% \n  filter(urea > 60 & glucose <= 160 & glucose >= 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id_jaula id_raton   tratamiento protocolo peso_inicial peso_final peso_utero\n1        1        1       control       ovx         26.0      33.28    123.000\n2       10       21 sham operated    no ovx         23.4      27.90      0.535\n   chol glucose    tag prot  urea album\n1 85.99  109.97 182.42   NA 66.27 66.82\n2 59.28  126.77 244.84   NA 60.37    NA\n```\n:::\n:::\n\n\n## Extra bonus: Crear pipeline\n\n### Pipeline crudo\n\n\n::: {.cell}\n\n```{.r .cell-code}\npreclin_data %>% \n  distinct(.keep_all = TRUE) %>% \n  filter(!(id_raton == 1 & protocolo == \"desconocido\")) %>% \n  filter(!(id_raton == 1 & id_jaula == 7)) %>% \n  mutate(urea = replace(urea, id_raton == 6, 65.2)) %>%\n  na_if(list(prot = -999)) %>% \n  na_if(list(protocolo = \"desconocido\")) %>% \n  mutate(prot = recode(prot,  `43131` = 4.5)) -> preclin_data_clean\n\npreclin_data_clean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   id_jaula id_raton               tratamiento protocolo peso_inicial\n1         1        1                   control       ovx        26.00\n2         1        2                   control       ovx        24.50\n3         1        3                   control       ovx        20.40\n4         2        4                   control   hemiovx        26.59\n5         2        5                   control       ovx        23.50\n6         2        6                      maca       ovx        25.00\n7         2        7                      maca       ovx        24.80\n8         3        8                      maca       ovx        23.20\n9         3        9                      maca   hemiovx        22.69\n10        3       10                      maca       ovx        23.90\n11        5       11             maca + critro      <NA>        21.90\n12        5       12             maca + critro       ovx        23.40\n13        5       13             maca + critro       ovx        21.90\n14        5       14             maca + critro       ovx        22.40\n15        8       15 triple dosis maca + citro       ovx        18.90\n16        8       16 triple dosis maca + citro       ovx        23.50\n17        9       17 triple dosis maca + citro       ovx        24.50\n18        9       18 triple dosis maca + citro       ovx        25.30\n19        9       19 triple dosis maca + citro       ovx        27.90\n20        9       20             sham operated    no ovx        25.50\n21       10       21             sham operated    no ovx        23.40\n22       10       22             sham operated    no ovx        22.50\n23       10       23             sham operated    no ovx        22.90\n   peso_final peso_utero    chol glucose    tag prot   urea album\n1       33.28    123.000  85.990  109.97 182.42 4.50  66.27 66.82\n2       30.50      0.063  94.460   81.62 211.87 4.68  76.73 55.36\n3       29.93      0.078  99.670  118.37 195.16   NA  52.32    NA\n4       32.19      0.134  83.380   71.91  98.46   NA  50.71    NA\n5       30.37      0.052  82.080   95.53 108.13 5.33  26.02    NA\n6       30.43      0.055 107.490  160.36 141.10   NA  65.20 72.14\n7       28.77      0.064  76.870  195.53  95.82 5.02  40.78 67.09\n8       27.30      0.062  95.760  182.41 105.49 6.12  66.94 70.64\n9       26.86      0.070  85.340  184.51  90.99   NA     NA 66.27\n10      29.10      0.113  82.080  168.50 143.30 4.85  34.48 83.73\n11      24.93      0.108  80.781  113.38 128.35   NA     NA    NA\n12      26.70      0.022  88.590  102.62 282.64   NA     NA    NA\n13      28.67      0.014 104.880   60.10 200.00 5.33  37.96    NA\n14      28.37      0.046  70.350  150.13 199.12 4.93  45.61 64.64\n15      23.80      0.057  78.170  110.50 114.73 4.78  38.23 52.77\n16      26.70      0.065  85.340  144.88 134.51 5.15  43.06 59.59\n17      28.77      0.016  64.400  138.85 160.44   NA     NA    NA\n18      29.20      0.068  67.100  140.68 127.03   NA     NA    NA\n19      29.48      0.076  65.790  114.70 169.67 6.17     NA    NA\n20      30.27      0.088  74.260   94.23 185.05 4.93     NA 68.59\n21      27.90      0.535  59.280  126.77 244.84   NA  60.37    NA\n22      26.68      0.081  68.400   78.22  93.19   NA 157.89    NA\n23      27.43      0.176  84.690  125.20 108.13   NA     NA    NA\n```\n:::\n:::\n\n\n### Pipeline documentado \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1) Datos crudos\npreclin_data %>% \n  \n  # 2) Eliminar duplicados de fila\n  distinct(.keep_all = TRUE) %>% \n  \n  # 3) Eliminar ratones con ID duplicado\n  filter(!(id_raton == 1 & protocolo == \"desconocido\")) %>% \n  filter(!(id_raton == 1 & id_jaula == 7)) %>% \n  \n  # 4) Remplazar dato perdido de urea por valor recuperado\n  mutate(urea = replace(urea, id_raton == 6, 65.2)) %>%\n  \n  # 5) Convertir a dato perdido valores camuflados (-999, \"desconocido\")\n  na_if(list(prot = -999)) %>% \n  na_if(list(protocolo = \"desconocido\")) %>% \n  \n  # 6) Corregir valor extremo no plausible\n  mutate(prot = recode(prot,  `43131` = 4.5)) -> preclin_data_clean\n\npreclin_data_clean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   id_jaula id_raton               tratamiento protocolo peso_inicial\n1         1        1                   control       ovx        26.00\n2         1        2                   control       ovx        24.50\n3         1        3                   control       ovx        20.40\n4         2        4                   control   hemiovx        26.59\n5         2        5                   control       ovx        23.50\n6         2        6                      maca       ovx        25.00\n7         2        7                      maca       ovx        24.80\n8         3        8                      maca       ovx        23.20\n9         3        9                      maca   hemiovx        22.69\n10        3       10                      maca       ovx        23.90\n11        5       11             maca + critro      <NA>        21.90\n12        5       12             maca + critro       ovx        23.40\n13        5       13             maca + critro       ovx        21.90\n14        5       14             maca + critro       ovx        22.40\n15        8       15 triple dosis maca + citro       ovx        18.90\n16        8       16 triple dosis maca + citro       ovx        23.50\n17        9       17 triple dosis maca + citro       ovx        24.50\n18        9       18 triple dosis maca + citro       ovx        25.30\n19        9       19 triple dosis maca + citro       ovx        27.90\n20        9       20             sham operated    no ovx        25.50\n21       10       21             sham operated    no ovx        23.40\n22       10       22             sham operated    no ovx        22.50\n23       10       23             sham operated    no ovx        22.90\n   peso_final peso_utero    chol glucose    tag prot   urea album\n1       33.28    123.000  85.990  109.97 182.42 4.50  66.27 66.82\n2       30.50      0.063  94.460   81.62 211.87 4.68  76.73 55.36\n3       29.93      0.078  99.670  118.37 195.16   NA  52.32    NA\n4       32.19      0.134  83.380   71.91  98.46   NA  50.71    NA\n5       30.37      0.052  82.080   95.53 108.13 5.33  26.02    NA\n6       30.43      0.055 107.490  160.36 141.10   NA  65.20 72.14\n7       28.77      0.064  76.870  195.53  95.82 5.02  40.78 67.09\n8       27.30      0.062  95.760  182.41 105.49 6.12  66.94 70.64\n9       26.86      0.070  85.340  184.51  90.99   NA     NA 66.27\n10      29.10      0.113  82.080  168.50 143.30 4.85  34.48 83.73\n11      24.93      0.108  80.781  113.38 128.35   NA     NA    NA\n12      26.70      0.022  88.590  102.62 282.64   NA     NA    NA\n13      28.67      0.014 104.880   60.10 200.00 5.33  37.96    NA\n14      28.37      0.046  70.350  150.13 199.12 4.93  45.61 64.64\n15      23.80      0.057  78.170  110.50 114.73 4.78  38.23 52.77\n16      26.70      0.065  85.340  144.88 134.51 5.15  43.06 59.59\n17      28.77      0.016  64.400  138.85 160.44   NA     NA    NA\n18      29.20      0.068  67.100  140.68 127.03   NA     NA    NA\n19      29.48      0.076  65.790  114.70 169.67 6.17     NA    NA\n20      30.27      0.088  74.260   94.23 185.05 4.93     NA 68.59\n21      27.90      0.535  59.280  126.77 244.84   NA  60.37    NA\n22      26.68      0.081  68.400   78.22  93.19   NA 157.89    NA\n23      27.43      0.176  84.690  125.20 108.13   NA     NA    NA\n```\n:::\n:::\n\n\n\n¡Ahora de click a `Render` y genere el reporte en *.html!",
    "supporting": [
      "aid_taller_solucionario_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}